<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Minimal AI Chat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #000000; 
            color: #ffffff;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .glass-header { background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(10px); border-bottom: 1px solid #222; }
        .chat-container { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 16px; }
        
        /* Bubble Chat Minimalis */
        .bubble-user { align-self: flex-end; background: #ffffff; color: #000000; padding: 10px 16px; border-radius: 20px 20px 4px 20px; max-width: 80%; font-size: 0.9rem; font-weight: 500; }
        .bubble-ai { align-self: flex-start; background: #111111; border: 1px solid #333; color: #ffffff; padding: 10px 16px; border-radius: 20px 20px 20px 4px; max-width: 80%; font-size: 0.9rem; }
        
        .input-area { padding: 16px; background: #000; border-top: 1px solid #222; }
        input::placeholder { color: #555; }
        
        /* Modal & Sidebar */
        .modal-bg { background: rgba(0,0,0,0.95); backdrop-filter: blur(5px); }
        .sidebar { background: #000; border-right: 1px solid #222; transform: translateX(-100%); transition: 0.3s; }
        .sidebar.active { transform: translateX(0); }
    </style>
</head>
<body>

    <div id="sidebar" class="fixed inset-y-0 left-0 w-64 z-50 sidebar flex flex-col p-6">
        <button onclick="toggleSidebar()" class="self-end mb-8"><i data-lucide="x"></i></button>
        <nav class="space-y-6">
            <a href="#" class="block text-lg hover:text-gray-400">Website Utama</a>
            <a href="#" class="block text-lg hover:text-gray-400">Portfolio</a>
            <button onclick="showSetup()" class="block text-lg text-left hover:text-gray-400 w-full">Ganti Sesi/Karakter</button>
        </nav>
    </div>

    <header class="h-16 flex items-center justify-between px-6 glass-header shrink-0">
        <div class="flex items-center gap-4">
            <button onclick="toggleSidebar()"><i data-lucide="align-left" class="w-5 h-5"></i></button>
            <div id="chat-identity" class="flex items-center gap-3 hidden">
                <div class="w-8 h-8 rounded-full bg-white flex items-center justify-center">
                    <i data-lucide="bot" class="w-5 h-5 text-black"></i>
                </div>
                <span id="display-name" class="font-bold text-sm tracking-tight uppercase"></span>
            </div>
        </div>
        <button onclick="toggleKeywordList()" class="text-[10px] border border-white/20 px-2 py-1 rounded hover:bg-white hover:text-black transition">
            CHAR LIST
        </button>
    </header>

    <main id="chat-container" class="chat-container">
        <div class="text-center text-gray-600 text-xs my-10" id="empty-state">Mulai percakapan baru...</div>
    </main>

    <footer class="input-area shrink-0">
        <div class="max-w-3xl mx-auto flex items-center gap-3 bg-[#111] border border-[#333] rounded-full px-5 py-2">
            <input type="text" id="user-input" class="flex-1 bg-transparent outline-none text-sm py-2" placeholder="Tulis sesuatu...">
            <button onclick="sendMessage()" class="text-white hover:scale-110 transition"><i data-lucide="arrow-up-circle"></i></button>
        </div>
    </footer>

    <div id="setup-modal" class="fixed inset-0 z-[60] modal-bg flex items-center justify-center p-6">
        <div class="w-full max-w-xs space-y-8">
            <div class="text-center">
                <h1 class="text-2xl font-bold tracking-tighter">AI INTERFACE</h1>
                <p class="text-gray-500 text-xs mt-2 uppercase tracking-widest">Faanrky Version</p>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="text-[10px] uppercase text-gray-500 font-bold ml-1">Session Key</label>
                    <input type="text" id="input-session" class="w-full bg-transparent border-b border-gray-800 py-3 px-1 outline-none focus:border-white transition text-sm" placeholder="Masukkan Sesi...">
                </div>
                <div>
                    <label class="text-[10px] uppercase text-gray-500 font-bold ml-1">Karakter Keyword</label>
                    <input type="text" id="input-keyword" class="w-full bg-transparent border-b border-gray-800 py-3 px-1 outline-none focus:border-white transition text-sm" placeholder="Contoh: hutao">
                </div>
                <button onclick="startChat()" class="w-full bg-white text-black font-bold py-4 rounded-full mt-4 hover:bg-gray-200 transition text-xs tracking-widest uppercase">
                    Masuk Ke Chat
                </button>
            </div>
        </div>
    </div>

    <div id="keyword-modal" class="fixed inset-0 z-[70] bg-black/80 hidden flex items-center justify-center p-6" onclick="toggleKeywordList()">
        <div class="bg-[#111] border border-[#333] p-6 rounded-2xl w-full max-w-xs" onclick="event.stopPropagation()">
            <h4 class="text-xs font-bold text-gray-500 uppercase mb-4 tracking-widest">Available Keywords</h4>
            <div id="keyword-list-content" class="space-y-3">
                </div>
            <button onclick="toggleKeywordList()" class="mt-6 w-full text-[10px] text-gray-500 uppercase">Tutup</button>
        </div>
    </div>

    <script>
        const categories = {
            "char": [
                { name: "Hu Tao", keyword: "hutao" },
                { name: "Zhao", keyword: "zhao" }
            ]
        };

        let sessionKey = "";
        let characterKeyword = "";

        lucide.createIcons();

        // Render Keyword List Info
        const listContent = document.getElementById('keyword-list-content');
        categories.char.forEach(c => {
            const item = document.createElement('div');
            item.className = "flex justify-between border-b border-[#222] pb-2";
            item.innerHTML = `<span class="text-sm">${c.name}</span> <code class="text-xs text-gray-500 bg-[#222] px-2 rounded">${c.keyword}</code>`;
            listContent.appendChild(item);
        });

        function startChat() {
            const s = document.getElementById('input-session').value.trim();
            const k = document.getElementById('input-keyword').value.trim().toLowerCase();

            if (!s || !k) return alert("Lengkapi data dulu bos!");

            sessionKey = s;
            characterKeyword = k;

            // Cari nama display dari keyword
            const found = categories.char.find(c => c.keyword === k);
            document.getElementById('display-name').innerText = found ? found.name : k;

            document.getElementById('setup-modal').classList.add('hidden');
            document.getElementById('chat-identity').classList.remove('hidden');
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
        }

        function toggleKeywordList() {
            document.getElementById('keyword-modal').classList.toggle('hidden');
        }

        function showSetup() {
            document.getElementById('setup-modal').classList.remove('hidden');
            toggleSidebar();
        }

        function appendMessage(sender, text) {
            const container = document.getElementById('chat-container');
            document.getElementById('empty-state').style.display = 'none';
            
            const div = document.createElement('div');
            div.className = sender === 'user' ? 'bubble-user' : 'bubble-ai';
            div.innerText = text;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        async function sendMessage() {
            const input = document.getElementById('user-input');
            const msg = input.value.trim();
            if (!msg || !characterKeyword) return;

            appendMessage('user', msg);
            input.value = '';

            try {
                const response = await fetch(`https://api.faanrky.my.id/c/${characterKeyword}?s=${sessionKey}&text=${encodeURIComponent(msg)}`);
                const data = await response.json();
                if (data.status) {
                    appendMessage('ai', data.result);
                } else {
                    appendMessage('ai', "Sistem Error.");
                }
            } catch (e) {
                appendMessage('ai', "Gagal terhubung ke API.");
            }
        }

        document.getElementById('user-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
    </script>
</body>
</html>
